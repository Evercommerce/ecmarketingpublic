var EcAttr=(function(){var QSPARAMS=getQueryParams();var TLD;var setDomain=function(_tld){if(!_tld||typeof _tld=="undefined"){TLD=extractHostname();}else{TLD=_tld;} return this;};var customParams=function(p){if(typeof p!="undefined"){for(var key in p){if(p.hasOwnProperty(key)){var cname=p[key];var value=QSPARAMS[key]||"";var current=readCookie(cname);if(current==undefined){createCookie(cname,value);} cname_lt=cname+"__last";createCookie(cname_lt,value);}}}else{console.warn("Custom Params must be provided as key:value pairs.");} return this;};var readCookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);} return null;};var prefill=function(map){if(typeof map!="undefined"){for(key in map){var cookieName=key;var fields=document.querySelectorAll(map[key]);for(field in fields){fields[field].value=readCookie(cookieName);}}}else{console.error("Must use key:value pairs for form prefill.");} return this;};var createCookie=function(name,value){if(!value){value="";} var expriation=new Date();expriation.setFullYear(expriation.getFullYear()+10);document.cookie=name+"="+ value+"; path=/"+"; domain="+ TLD+"; expires="+ expriation.toGMTString()+";";};var extractHostname=function(){var url=window.location.href;var hostname;if(url.indexOf("://")>-1){hostname=url.split("/")[2];}else{hostname=url.split("/")[0];} hostname=hostname.split(":")[0];hostname=hostname.split("?")[0];var hostnames=hostname.split(".");hostname=hostnames[hostnames.length-2]+"."+hostnames[hostnames.length-1];return hostname;};var standardParams=function(){var currentKeywordCookie=readCookie("Keyword__c");var currentReferringSiteCookie=readCookie("Referring_Site_Cookie__c");var currentLeadCookie=readCookie("Lead_Cookie__c");var currentFirstPageCookie=readCookie("firstPageCookie");var currentMsid=readCookie("ecmsid");if(currentFirstPageCookie!=1){if(currentKeywordCookie===undefined||currentKeywordCookie===null){createCookie("Keyword__c",QSPARAMS["keyword"]);} if(currentReferringSiteCookie===undefined||currentReferringSiteCookie===null){createCookie("Referring_Site_Cookie__c",document.referrer);} if(currentLeadCookie===undefined||currentLeadCookie===null){createCookie("Lead_Cookie__c",window.location.pathname);} createCookie("firstPageCookie",1);} if((currentMsid===undefined||currentMsid===null)&&QSPARAMS["msid"]){createCookie("ecmsid",QSPARAMS["msid"]);} createCookie("Keyword__c__last",QSPARAMS["keyword"]);createCookie("Referring_Site_Cookie__c__last",document.referrer);createCookie("Lead_Cookie__c__last",window.location.pathname);createCookie("ecmsid__last",QSPARAMS["msid"]);};function getQueryParams(){var pairs=location.search.slice(1).split("&");var result={};pairs.forEach(function(pair){pair=pair.split("=");result[pair[0]]=decodeURIComponent(pair[1]||"");});return JSON.parse(JSON.stringify(result));} setDomain();standardParams();return{setDomain:setDomain,readCookie:readCookie,custom:customParams,prefill:prefill};})();