/**
 * Author: EverCommerce
 * Author URI: https://www.evercommerce.com/
 * Version: 1.0.0
 * Updated: 02/19/2024
 * 
 * Copyright EverCommerce
 * All Rights Reserved.
 * 
 * NOTICE: Unauthorized use or copying of this file
 *         via any medium is strictly prohibited.
 *         Proprietary and confidential
 */
(()=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},n(e)}function e(n){return function(n){if(Array.isArray(n))return t(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"==typeof n)return t(n,e);var r=Object.prototype.toString.call(n).slice(8,-1);"Object"===r&&n.constructor&&(r=n.constructor.name);if("Map"===r||"Set"===r)return Array.from(n);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function r(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,o(r.key),r)}}function i(n,e,t){return(e=o(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=function(){function n(){var e=this;if(function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),i(this,"log",(function(){console.group("%cAbout $ECP","color: #16CA94"),console.log("Version: ",e.version),console.log("Config:",e.config),console.groupEnd(),console.group("%cAnalytics APIs","color: #16CA94"),e.apis.analytics?console.log('Segment\'s "analytics" APIs will be used for track and identify'):e.apis.heap?console.log('Heap\'s "heap" APIs will be used for track and identify'):console.log("No analytics API defined."),console.groupEnd()})),i(this,"identify",(function(n){var t,r;if(n){if(e.apis.analytics||e.apis.heap){var i=(null===(t=window)||void 0===t||null===(t=t.analytics)||void 0===t||null===(t=t.user())||void 0===t?void 0:t.id())||(null===(r=window)||void 0===r||null===(r=r.heap)||void 0===r?void 0:r.identity)||!1;if(!1!==i)return i;var o=e.generateGUID(n);return e.apis.analytics?window.analytics.identify(o):e.apis.heap?window.heap.identify(o):console.error("$ECP Error: Unable to identify user."),o}console.error("$ECP Error: Cannot identify, identify API is not defined.")}else console.error("$ECP Error: Cannot identify, missing email.")})),i(this,"track",(function(n,t){n?(n.startsWith("Product - ")||(n="Product - ".concat(n)),e.apis.analytics?window.analytics.track(n,t):e.apis.heap&&window.heap.track(n,t)):console.error("$ECP Error: Missing event name.")})),i(this,"generateGUID",(function(n){var e=function(n){function e(n,e){return(e>>>n|e<<32-n)>>>0}return function(){for(var t=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),r=new Uint32Array(64),i=1779033703,o=3144134277,a=1013904242,l=2773480762,c=1359893119,s=2600822924,u=528734635,f=1541459225,d=function(n){for(var e=(448-n.length-1)%512,t=new Uint8Array(e/8+1).fill(0),r=8*n.length,i=new Uint8Array(8),o=0;o<8;o++)i[o]=r>>>56-8*o&255;for(var a=new Uint8Array(n.length+1+t.length+i.length),l=0;l<n.length;l++)a[l]=n[l];a[n.length]=128;for(var c=0;c<t.length;c++)a[n.length+1+c]=t[c];for(var s=0;s<i.length;s++)a[n.length+1+t.length+s]=i[s];return a}(n.split("").map((function(n){return n.charCodeAt(0)}))),y=function(n){if("string"!=typeof n&&(n=n.toString()),!n.length)return new Uint32Array(0);for(var e=new Uint32Array(n.length/4),t=0;t<n.length;t+=4)e[t/4]=n.charCodeAt(t)<<24|n.charCodeAt(t+1)<<16|n.charCodeAt(t+2)<<8|n.charCodeAt(t+3);return e}(d),p=0;p<y.length;p+=16){for(var h=r,g=0;g<16;g++)h[g]=y[p+g];for(var v=16;v<64;v++){var w=e(7,h[v-15])^e(18,h[v-15])^h[v-15]>>>3,b=e(17,h[v-2])^e(19,h[v-2])^h[v-2]>>>10;h[v]=h[v-16]+w+h[v-7]+b>>>0}for(var m=i,E=o,C=a,A=l,P=c,S=s,$=u,j=f,U=0;U<64;U++){var I=f+(e(6,c)^e(11,c)^e(25,c))+(c&s^~c&u)+t[U]+h[U]>>>0;j=$,$=S,S=P,P=A+I>>>0,A=C,C=E,E=m,m=I+((e(2,i)^e(13,i)^e(22,i))+(i&o^i&a^o&a)>>>0)>>>0}i=i+m>>>0,o=o+E>>>0,a=a+C>>>0,l=l+A>>>0,c=c+P>>>0,s=s+S>>>0,u=u+$>>>0,f=f+j>>>0}return[i,o,a,l,c,s,u,f].map((function(n){return n.toString(16).padStart(8,"0")})).join("")}()}(n=n.toLowerCase().trim());return e.slice(0,8)+"-"+e.slice(8,12)+"-4"+e.slice(13,16)+"-a"+e.slice(17,20)+"-"+e.slice(20)})),this.version="1.0.0",this.q=window.$ECP.q,this.config=window.$ECP.config,this.apis={analytics:!1,heap:!1},window.$ECP.config.debug){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://cdn.jsdelivr.net/gh/Evercommerce/ecmarketingpublic@main/ecpDebugger.min.js",document.body.appendChild(t),document.addEventListener("debuggerSetup",(function(){e._initialize(window.$ECP.config)}))}else this._initialize(window.$ECP.config)}var t,o,a;return t=n,(o=[{key:"_handleQueuedEvents",value:function(){var n=this;this.q&&this.q.forEach((function(t){var r=t[0],i=t.slice(1);["getFirst","getLast","generateGUID"].includes(r)?console.error("$ECP Error: Method ".concat(r,"(").concat(i.join(", "),") cannot be queued, called too early.")):(console.warn("$ECP Method $ECP.".concat(r,"(").concat(i,") called before $ECP initialized. Calling now...")),n[r].apply(n,e(i)))}))}},{key:"_initialize",value:function(n){var e=this;this.initialized?console.warn("$ECP has already been initialized."):(this.config=n||{},this.initialized=!0,window.addEventListener("load",(function(){e.apis.analytics=void 0!==window.analytics,e.apis.heap=void 0!==window.heap,e._handleQueuedEvents()})))}}])&&r(t.prototype,o),a&&r(t,a),Object.defineProperty(t,"prototype",{writable:!1}),n}();window.$ECP=new a})();
