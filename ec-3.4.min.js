/**
 * Author: EverCommerce
 * Author URI: https://www.evercommerce.com/
 * Version: 3.4
 * Updated: 03/15/2023
 * 
 * Copyright EverCommerce
 * All Rights Reserved.
 * 
 * NOTICE: Unauthorized use or copying of this file
 *         via any medium is strictly prohibited.
 *         Proprietary and confidential
 */
(()=>{"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function i(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===t(n)?n:String(n)}e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var c=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"getFirst",(function(){return t.readCookie("__ecatft")})),i(this,"getLast",(function(){return t.readCookie("__ecatlt")})),i(this,"setDomain",(function(e){t.domain=e||t.extractHostname()})),i(this,"autofill",(function(e){var n=t.readCookie("__ecatft"),r=t.readCookie("__ecatlt");if(!e)return console.error("[$EC Error] Must provide field map to autofill form fields."),!1;t.debug&&(console.group("[$EC Debug] Field Mapping"),console.table(e),console.groupEnd()),setTimeout((function(){e.hasOwnProperty("utm_campaign")?Object.keys(e).forEach((function(t){document.querySelectorAll(e[t].first).forEach((function(e){e.value=n[t]||"[blank]"})),document.querySelectorAll(e[t].last).forEach((function(e){e.value=r[t]||"[blank]"}))})):e.hasOwnProperty("first_touch")&&(Object.keys(e.first_touch).forEach((function(t){document.querySelectorAll(e.first_touch[t]).forEach((function(e){e.value=n[t]||"[blank]"}))})),Object.keys(e.last_touch).forEach((function(t){document.querySelectorAll(e.last_touch[t]).forEach((function(e){e.value=r[t]||"[blank]"}))})))}),50)})),i(this,"log",(function(){console.group("About $EC"),console.log("Version: ",t.version),console.log("Domain: ",t.domain),void 0!==window.heap&&window.heap.identity&&console.log("[$EC] Heap ID: ",window.heap.identity),console.groupEnd();var e=t.readCookie("__ecatft"),n=t.readCookie("__ecatlt");console.group("First Touch (Standard)"),console.table(e),console.groupEnd(),console.group("Last Touch (Standard)"),console.table(n),console.groupEnd()})),i(this,"heap",{identify:function(e){if(e){var n=!1;if(void 0!==window.heap&&(n=!0),!n){if(t.debug)return console.error("[$EC Error] Heap API is not defined."),t.generateUUID(e);if(!t.debug)return}if(window.heap.identity&&t.debug&&console.log("[$EC Debug] Already Identified: ",window.heap.identity),!window.heap.identity){var r=t.generateUUID(e);window.heap.identify(r),t.debug&&console.log("[$EC Debug] Identified with: ",r)}return window.heap.identity}console.error("[$EC Error] Must provide an email address.")},autofill:function(e,n){for(var r=document.forms,o=function(){var o=r[i];return o.classList.contains("mktoForm")||o.classList.contains("ecmktoForm")?"continue":void o.addEventListener("submit",(function(r){r.preventDefault();var i=o.querySelector(e).value,a=o.querySelector(n);if(i){var c=t.heap.identify(i);void 0!==a&&(a.value=c)}o.submit()}))},i=0;i<r.length;i++)o()}}),i(this,"mktoBlindForm",{load:function(e,n,r){var o=document.createElement("form");o.id="mktoForm_".concat(r),t.debug||(o.style.display="none"),t.debug&&console.warn("[$EC Warning] Debug Mode is enabled. Marketo Form is displayed. Disable Debug mode for production use.",o),document.body.appendChild(o);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="//".concat(e,"/js/forms2/js/forms2.min.js"),document.body.appendChild(i),i.addEventListener("load",(function(){window.MktoForms2.loadForm("//".concat(e),n,r,(function(e){e.onSubmit((function(){if(e.validate()&&void 0!==window.heap){var n=e.vals().Email,r=t.heap.identify(n);e.addHiddenFields({ec_heap_id__c:r})}t.debug&&(console.group("[$EC Debug] Form Vals"),console.table(e.vals()),console.groupEnd())})),e.onSuccess((function(){return void 0!==window.dataLayer&&window.dataLayer.push({event:"MarketoFormSubmit"}),!1}))})),t.handleMktoFormHiddenFields()}))},submit:function(e,n){var r=document.querySelector(e);window.MktoForms2.whenReady((function(e){e.vals(t.mktoBlindForm.mapVals(r,n)),e.submit()}))},mapVals:function(e,t){var r={};return Object.entries(t).forEach((function(t){var o,i=n(t,2),a=i[0],c=i[1],u=e.querySelector(a);u?(o="checkbox"==u.type?u.checked?"yes":"no":u.value,r[c]=o):console.error("[$EC Error] Field with selector ".concat(a," does not exist."))})),r}}),this.version=3.4,this.debug||(this.debug=!1),this.setDomain(),this.handleAttributionCookie(),void 0!==window.MktoForms2&&this.handleMktoFormHiddenFields()}var t,r,a;return t=e,(r=[{key:"extractHostname",value:function(){var e,t=window.location.href;if("localhost"!==(e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?window.location.hostname:t.indexOf("://")>-1?t.split("/")[2]:t.split("/")[0])&&"127.0.0.1"!==e){var n=(e=(e=e.split(":")[0]).split("?")[0]).split(".");e=n[n.length-2]+"."+n[n.length-1]}return e}},{key:"handleAttributionCookie",value:function(){var e=this.readCookie("__ecatft"),t=this.readCookie("__ecatlt"),n=new URLSearchParams(document.location.search),r={utm_campaign:n.get("utm_campaign")?n.get("utm_campaign").substring(0,254):"",utm_source:n.get("utm_source")?n.get("utm_source").substring(0,254):"",utm_medium:n.get("utm_medium")?n.get("utm_medium").substring(0,254):"",utm_content:n.get("utm_content")?n.get("utm_content").substring(0,254):"",utm_term:n.get("utm_term")?n.get("utm_term").substring(0,254):"",utm_device:n.get("utm_device")?n.get("utm_device").substring(0,254):"",referrer:document.referrer.split("?")[0].substring(0,254)||"",gclid:n.get("gclid")?n.get("gclid").substring(0,254):"",lp:(document.location.hostname+document.location.pathname).substring(0,254)||""};0===Object.keys(e).length&&this.createCookie("__ecatft",r),0===Object.keys(t).length&&this.createCookie("__ecatlt",r)}},{key:"handleMktoFormHiddenFields",value:function(){var e=this;window.MktoForms2.whenReady((function(t){var n=e.readCookie("__ecatft"),r=e.readCookie("__ecatlt"),o={ec_utm_campaign_first__c:n.utm_campaign||"NULL",ec_utm_source_first__c:n.utm_source||"NULL",ec_utm_medium_first__c:n.utm_medium||"NULL",ec_utm_content_first__c:n.utm_content||"NULL",ec_utm_term_first__c:n.utm_term||"NULL",ec_utm_device_first__c:n.utm_device||"NULL",gclid__c:n.gclid||"NULL",GCLID__c:n.gclid||"NULL",ec_landing_page_first__c:n.lp||"NULL",ec_referrer_first__c:n.referrer||"NULL",ec_utm_campaign_last__c:r.utm_campaign||"NULL",ec_utm_source_last__c:r.utm_source||"NULL",ec_utm_medium_last__c:r.utm_medium||"NULL",ec_utm_content_last__c:r.utm_content||"NULL",ec_utm_term_last__c:r.utm_term||"NULL",ec_utm_device_last__c:r.utm_device||"NULL",gclid_last__c:r.gclid||"NULL",GCLID_last__c:r.gclid||"NULL",ec_referrer_last__c:r.referrer||"NULL",ec_landing_page_last__c:r.lp||"NULL"};t.addHiddenFields(o),t.onSubmit((function(){if(t.validate()&&void 0!==window.heap){var n=t.vals().Email,r=e.heap.identify(n);t.addHiddenFields({ec_heap_id__c:r})}e.debug&&(console.group("[$EC Debug] Form Vals"),console.table(t.vals()),console.groupEnd())})),t.onSuccess((function(){void 0!==window.dataLayer&&window.dataLayer.push({event:"MarketoFormSubmit"})}))}))}},{key:"createCookie",value:function(e,t){if(e)if(t){var n=t?JSON.stringify(t):"",r="";if("__ecatft"==e){var o=new Date;o.setFullYear(o.getFullYear()+10),r=" expires="+o.toUTCString()+";"}document.cookie=e+"="+n+"; path=/; domain="+this.domain+";"+r}else console.error("[$EC Error] Must provide a value.");else console.error("[$EC Error] Must provide a name.")}},{key:"readCookie",value:function(e){if(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return JSON.parse(o.substring(t.length,o.length))}return{}}console.error("[$EC Error] Must provide a name.")}},{key:"generateUUID",value:function(e){var t=function(e){function t(e,t){return(t>>>e|t<<32-e)>>>0}return function(){for(var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),r=new Uint32Array(64),o=1779033703,i=3144134277,a=1013904242,c=2773480762,u=1359893119,l=2600822924,s=528734635,d=1541459225,f=function(e){for(var t=(448-e.length-1)%512,n=new Uint8Array(t/8+1).fill(0),r=8*e.length,o=new Uint8Array(8),i=0;i<8;i++)o[i]=r>>>56-8*i&255;for(var a=new Uint8Array(e.length+1+n.length+o.length),c=0;c<e.length;c++)a[c]=e[c];a[e.length]=128;for(var u=0;u<n.length;u++)a[e.length+1+u]=n[u];for(var l=0;l<o.length;l++)a[e.length+1+n.length+l]=o[l];return a}(e.split("").map((function(e){return e.charCodeAt(0)}))),m=function(e){if("string"!=typeof e&&(e=e.toString()),!e.length)return new Uint32Array(0);for(var t=new Uint32Array(e.length/4),n=0;n<e.length;n+=4)t[n/4]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3);return t}(f),_=0;_<m.length;_+=16){for(var g=r,h=0;h<16;h++)g[h]=m[_+h];for(var p=16;p<64;p++){var v=t(7,g[p-15])^t(18,g[p-15])^g[p-15]>>>3,y=t(17,g[p-2])^t(19,g[p-2])^g[p-2]>>>10;g[p]=g[p-16]+v+g[p-7]+y>>>0}for(var b=o,w=i,L=a,k=c,E=u,C=l,S=s,U=d,F=0;F<64;F++){var A=d+(t(6,u)^t(11,u)^t(25,u))+(u&l^~u&s)+n[F]+g[F]>>>0;U=S,S=C,C=E,E=k+A>>>0,k=L,L=w,w=b,b=A+((t(2,o)^t(13,o)^t(22,o))+(o&i^o&a^i&a)>>>0)>>>0}o=o+b>>>0,i=i+w>>>0,a=a+L>>>0,c=c+k>>>0,u=u+E>>>0,l=l+C>>>0,s=s+S>>>0,d=d+U>>>0}return[o,i,a,c,u,l,s,d].map((function(e){return e.toString(16).padStart(8,"0")})).join("")}()}(e=e.toLowerCase().trim());return t.slice(0,8)+"-"+t.slice(8,12)+"-4"+t.slice(13,16)+"-a"+t.slice(17,20)+"-"+t.slice(20)}}])&&o(t.prototype,r),a&&o(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.$EC=new c})();